# Macroegalitarianism and Women as Chief Executives: The Case of Korea

As we noted in our opening chapters, perceptions that moves toward gender equality prompt backlashes in public opinion are widespread.
Therefore, it would come as no surprise if there are, among those reading these pages, some who will find at least some of the conclusions of the two previous chapters too good to believe, in particular those regarding public responsiveness.
Recall that, across the countries of the OECD over several decades, we found evidence for not only democratic representation, politics and policy reflecting public opinion, but also _positive_ public responsiveness to politics and policy, that is, that public opinion responds to women's electoral success and the adoption of more gender egalitarian policies by growing _more_ egalitarian.
Such accelerating feedback is the exact opposite of what many observers fear is true.

Korea's recent political history provides a strong basis for their fears that public opinion lashes back against women's successes in winning office and other moves toward gender equality.
If public opinion backlash does not occur, how are we to understand events like Korea electing to its presidency Park Geun-hye, the country's first woman to hold the office, and then, two campaigns later, electing Yoon Seok-yeol, a man who built his political ascent around his anti-egalitarian views?
At least on its face, this sequence of events appears to contradict our conclusions.

In this chapter, we [dive deeper into the Korean case to take advantage of strengths of case studies]


> Justifications of case studies: theory generating. VanEvera1998; Gerring2004

> Justifications of doing a case study of _Korea_: a particularly challenging case for our conclusions/poorly explained by our model.  (outlier per VanEvera1998; deviant per Seawright2008)
Others?

> Hypotheses: i. Maybe woman _chief executives_ like Park are so much more visible that they trigger public opinion backlash? We don't test this in Chapter 4. ii. Maybe chief executives with family ties [Jalalzai2008], because they can be easily viewed as not having been elected on their own merits?  iii. Maybe _bad_ chief executives trigger backlash?  

```{r setup, include=FALSE}
options(tinytex.verbose = TRUE)

knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  cache = TRUE,
  dpi = 1000,
  fig.width = 7.5,
  fig.height = 4,
  dev = "cairo_pdf"
)

if (!require(pacman))
  install.packages("pacman")
library(pacman)

p_install(janitor, force = FALSE)

p_load(
  # analysis
  brms,
  doRNG,
  doParallel,
  CPC,
  
  # presentation
  gridExtra,
  modelsummary,
  dotwhisker,
  ggthemes,
  latex2exp,
  RColorBrewer,
  colorRamps,
  directlabels,
  patchwork,
  magick,
  
  # data wrangling
  broom,
  countrycode,
  DCPOtools,
  glue,
  here,
  labelled,
  janitor,
  tidyverse)

make_variable <- function(v_var, v1, t_data1) {
  
  v_variable <- v1 %>% 
    pull({{ v_var }})
  
  if (is.na(v_variable)) {
    t_data1[[v_var]] <- NA_integer_
  } else if (length(unlist(strsplit(v_variable,
                                    split = " "))) == 1) {
    t_data1[[v_var]] <- with(t_data1, 
                            as.numeric(get(v_variable) %>%
                                         stringr::str_trim()))
  } else {
    t_data1[[v_var]] <- with(t_data1,
                            eval(parse(text = v_variable)))
  }
  
  t_data2 <- t_data1 %>% 
    select({{ v_var }})
  
  return(t_data2)
}

survey_setup <- function(vars,
                         datapath = "../data/dcpo_surveys",
                         file = "",
                         chime = TRUE,
                         survey_additions = NULL,
                         ...) {
  if ("data.frame" %in% class(vars)) {
    vars_table <- vars
  } else {
    vars_table <- readr::read_csv(vars, col_types = cols(.default = "c"))
  }
  
  surveys_data <- DCPOtools::surveys_data
  
  dots <- list(...)
  
  # loop rather than purrr to avoid reloading datasets (some are big and slow)
  all_sets <- list()
  for (i in seq(nrow(vars_table))) {
    cat(i, " ")
    v <- vars_table[i, ]
    ds <- surveys_data[surveys_data$survey==v$survey, ]
    
    # Import dataset (if necessary)
    if (vars_table[["survey"]][i] != c(0, head(vars_table[["survey"]], -1))[i]) {
      dataset_path <- file.path(datapath,
                                paste0(ds$archive, "_files"),
                                paste0(ds$surv_program, "_files"),
                                ds$file_id)
      dataset_file <- list.files(path = dataset_path) %>% stringr::str_subset(".RData") %>% last()
      if (!is.na(ds$subfile)) dataset_file <- paste0(ds$subfile, ".RData") # error message needed: this errors if survey is not included in surveys_data
      t_data <- rio::import(file.path(dataset_path, dataset_file), trust = TRUE)
      
      # Fix column names and make lowercase
      valid_column_names <- stringr::str_to_lower(names(t_data)) %>%
        make.names(names = ., unique = TRUE, allow_ = TRUE)
      names(t_data) <- valid_column_names
      
      # Get countries
      suppressWarnings(
        t_data$c_dcpo <- if (ds$country_var %in% names(t_data)) {
          if (is.null(attr(t_data[[ds$country_var]], "labels"))) {
            if (!is.null(attr(t_data[[ds$country_var]], "value.labels"))) {
              attr(t_data[[ds$country_var]], "labels") <- attr(t_data[[ds$country_var]],
                                                               "value.labels") %>% as.numeric()
              attr(attr(t_data[[ds$country_var]], "labels"), "names") <- attr(attr(t_data[[ds$country_var]],
                                                                                   "value.labels"), "names")
            }
          }
          t_data[[ds$country_var]] %>%
            {if (!is.null(attr(t_data[[ds$country_var]], "labels")))
              labelled::labelled(., attr(., "labels")) %>%
                labelled::to_factor(levels = "prefixed") %>%
                forcats::fct_relabel(., function(x) stringr::str_replace(x, "\\[\\d+\\]\\s+", ""))
              else .} %>%
            as.character() %>%
            stringr::str_replace("Haití", "Haiti") %>%
            stringr::str_replace("Brasil", "Brazil") %>%
            stringr::str_replace("MÃ©xico", "Mexico") %>%
            stringr::str_replace("PerÃº", "Peru") %>%
            stringr::str_replace("PanamÃ¡", "Panama") %>%
            stringr::str_replace("República Dominicana", "Dominican Republic") %>%
            stringr::str_replace("Rep\\. Dominicana", "Dominican Republic") %>%
            {if (!is.na(ds$cc_dict))
              countrycode(., "orig", "dest", custom_dict = eval(parse(text = ds$cc_dict)))
              else if (!is.na(ds$cc_origin) & !is.na(ds$cc_match))
                countrycode(., ds$cc_origin, "country.name", custom_match = eval(parse(text = ds$cc_match)))
              else if (!is.na(ds$cc_origin))
                countrycode(., ds$cc_origin, "country.name")
              else if (!is.na(ds$cc_match))
                countrycode(., "country.name", "country.name",
                            custom_match = eval(parse(text = ds$cc_match)))
              else countrycode(., "country.name", "country.name")}
        } else ds$country_var %>%
          countrycode(., "country.name", "country.name")
      )
      if (ds$survey == "wvs4_swe") {
        t_data <- labelled::remove_labels(t_data)
        t_data <- t_data %>%
          dplyr::filter(c_dcpo == "Sweden")
      }
      if (ds$survey == "wvs6_bahrain") {
        t_data <- labelled::remove_labels(t_data)
        t_data <- t_data %>%
          dplyr::filter(c_dcpo == "Bahrain")
      }
      if (ds$survey == "tcmeg2004") {
        t_data <- t_data %>%
          dplyr::filter(msurvey == 2)
      }
      if (ds$survey == "cdcee") {
        t_data <- t_data %>%
          dplyr::filter(!v3 == 16)
      }
      if (ds$survey == "pew2002") {
        t_data <- t_data %>%
          dplyr::filter(!country %in% c(1, 4, 5, 8, 11, 15, 16, 17,
                                        18, 9, 23, 27, 32, 42, 43))
        # urban-heavy samples: c("Angola", "Bolivia", "Brazil", "China", "Egypt", "Guatemala", "Honduras", "India", "Indonesia", "Côte d’Ivoire", "Mali", "Pakistan", "Senegal", "Venezuela", "Vietnam")
      }
      if (ds$survey == "pew2005_6") {
        t_data <- t_data %>%
          dplyr::filter(!country %in% c(10, 12))
        # urban-heavy samples: c("Morocco", "Pakistan")
      }
      if (ds$survey == "pew2005_11") {
        t_data <- t_data %>%
          dplyr::filter(!country %in% c(3, 6))
        # urban-heavy samples: c("China", "India")
      }
      if (ds$country_var %in% names(t_data)) {
        t_data <- t_data %>%
          mutate(c_dcpo = if_else(!is.na(c_dcpo), c_dcpo, as.character(.data[[ds$country_var]])))
      }
      
      # Get years
      t_data$y_dcpo <- if (!is.na(ds$year_dict)) { # if there's a year dictionary...
        if (!is.na(ds$year_var)) { # if there's a year variable
          t_data[[ds$year_var]] %>%
            labelled::labelled(., attr(., "labels")) %>%
            labelled::to_factor(levels = "labels") %>%
            as.character() %>%
            countrycode("orig", "year", custom_dict = eval(parse(text = ds$year_dict)), warn = FALSE)
        } else { # no year variable
          t_data[[ds$country_var]] %>%
            labelled::labelled(., attr(., "labels")) %>%
            labelled::to_factor(levels = "labels") %>%
            as.character() %>%
            countrycode("orig", "year", custom_dict = eval(parse(text = ds$year_dict)), warn = FALSE)
        }
      } else if (!is.na(ds$year_var)) { # if there's a year variable...
        if (length(unique(t_data$c_dcpo))==1) { # single-country study
          t_data[[ds$year_var]]
        } else if (stringr::str_detect(ds$survey, "ess")) {
          if ("inwyr" %in% names(t_data)) {
            t_data %>%
              group_by(c_dcpo) %>%
              mutate(year = ifelse(!is.na(inwyr) & !inwyr==9999, inwyr, 2000 + essround * 2),
                     y_dcpo = round(mean(year, na.rm = TRUE))) %>%
              ungroup() %>%
              .[["y_dcpo"]]
          } else if ("inwyys" %in% names(t_data)) {
            t_data %>%
              group_by(c_dcpo) %>%
              mutate(year = ifelse(!is.na(inwyys) & !inwyys==9999, inwyys, 2000 + essround * 2),
                     y_dcpo = round(mean(year, na.rm = TRUE))) %>%
              ungroup() %>%
              .[["y_dcpo"]]
          } else if ("inwde" %in% names(t_data)) {
            t_data %>%
              group_by(c_dcpo) %>%
              mutate(year = lubridate::year(inwde),
                     y_dcpo = round(mean(year, na.rm = TRUE))) %>%
              ungroup() %>%
              .[["y_dcpo"]]
          }
        } else if (ds$survey == "cdcee" | ds$survey == "eqls_combo") {
          suppressWarnings(
            t_data[[ds$year_var]] %>%
              labelled::labelled(., attr(., "labels")) %>%
              labelled::to_character(levels = "prefixed") %>%
              stringr::str_extract("\\d{4}")
          )
        } else if (ds$survey %in% c("amb_combo", "wrp19_21")) {
          t_data[[ds$year_var]]
        } else if (ds$survey == "neb_combo") {
          floor(t_data[[ds$year_var]])
        } else if (ds$survey == "ndb_combo") {
          case_when(t_data[[ds$year_var]] == 1 ~ 1991,
                    t_data[[ds$year_var]] == 2 ~ 1992,
                    t_data[[ds$year_var]] == 3 ~ 1994,
                    t_data[[ds$year_var]] == 4 ~ 1996,
                    t_data[[ds$year_var]] == 5 ~ 1998)
        } else if (ds$surv_program == "afrob" |   # single-wave cross-national surveys
                   ds$survey == "arabb3" |        # with interviews bleeding over years
                   ds$survey == "asianb3") {
          t_data %>%
            mutate(year = lubridate::year(t_data[[ds$year_var]]),
                   modal_year = as.integer(names(table(year)[table(year)==max(table(year))])),
                   year = if_else(is.na(year) | year < 1950,
                                  modal_year,
                                  as.integer(year)),
                   group_dcpo = c_dcpo) %>%
            group_by(c_dcpo) %>%
            mutate(y_dcpo = round(mean(year))) %>%
            ungroup() %>%
            .[["y_dcpo"]]
        } else { # cross-national surveys with interviews bleeding over years
          t_data %>%
            mutate(modal_year = as.integer(names(table(t_data[[ds$year_var]])[table(t_data[[ds$year_var]])==max(table(t_data[[ds$year_var]]))])),
                   year = if_else(between(as.numeric(t_data[[ds$year_var]]),
                                          1950, as.numeric(lubridate::year(Sys.Date()))),
                                  as.integer(t_data[[ds$year_var]]),
                                  modal_year),
                   group_dcpo = c_dcpo) %>%
            {if (!is.na(ds$cy_var))
              mutate(., group_dcpo = t_data[[ds$cy_var]])
              else .} %>%
            group_by(group_dcpo) %>%
            mutate(y_dcpo = round(mean(year))) %>%
            ungroup() %>%
            .[["y_dcpo"]]
        }
      } else as.numeric(ds$year)
      t_data$y_dcpo <- as.numeric(t_data$y_dcpo)
      t_data <- t_data %>%
        filter(!is.na(y_dcpo))
      
      # Get weights
      if (!is.na(ds$wt) & !all(is.na(ds$wt))) {
        if (length(unlist(strsplit(ds$wt, split = " "))) == 1) {
          wt <- as.numeric(with(t_data, get(ds$wt)))
        } else eval(parse(text = ds$wt))
        t_data$wt_dcpo <- wt
        t_data <- t_data %>%
          dplyr::group_by(c_dcpo, y_dcpo) %>%
          dplyr::mutate(wt_dcpo = wt_dcpo/mean(wt_dcpo, na.rm = TRUE)) %>%
          ungroup()
        t_data$wt_dcpo[is.na(t_data$wt_dcpo)] <- 1
        rm(wt)
      } else t_data$wt_dcpo <- 1
    }
    
    # Get variables of interest
    v_vars <- setdiff(names(v), "survey")
    targets <- map(v_vars, ~ make_variable(.x, v, t_data)) %>%
      list_cbind()
    
    # Report variables of interest
    vars1 <- t_data %>%
      dplyr::select(country = c_dcpo,
                    year = y_dcpo, 
                    weight = wt_dcpo) %>%
      bind_cols(targets) %>% 
      mutate(survey = v$survey)
    
    all_sets[[i]] <- vars1
    rm(vars1)
  }
  
  suppressWarnings(
    all_data <- bind_rows(all_sets)
  )
  rm(list = c("t_data", "ds", "v"))
  
  if(file!="") {
    rio::export(all_data, file = file)
  }
  
  return(all_data)
  
  # Chime
  if(chime) {
    beepr::beep()
  }
  
}

oecd_countries <- c("Australia", "Austria", "Belgium",
                    "Canada", "Chile", "Colombia",
                    "Costa Rica", "Czechia", "Denmark",
                    "Estonia", "Finland", "France", 
                    "Germany", "Greece", "Hungary",
                    "Iceland", "Ireland", "Israel",
                    "Italy", "Japan", "South Korea",
                    "Latvia", "Lithuania", "Luxembourg",
                    "Mexico", "Netherlands", "New Zealand",
                    "Norway", "Poland", "Portugal", 
                    "Slovakia", "Slovenia", "Spain",
                    "Sweden", "Switzerland", "Turkey", 
                    "United Kingdom", "United States")
```


## Park's Rise and Fall

narrowly loses 2007 primary
takes over as party leader at end of 2011
elected president in Dec 2012, 51.6% to 48.0%

@Seo2021 on scandal and impeachment

@Lee2023: not much backlash in public opinion, because Park was primarily seen as a dynastic candidate rather than a woman candidate
@Woo2025a: backlash in public opinion
@Kim2022b: backlash in Korea re gender quota

```{r eap}
eap <- rio::import(here("paper",
                        "korea",
                        "data-raw",
                        "EAD 3.0 Annual_11282023.dta"))

eapq0 <- rio::import(here("paper",
                         "korea",
                         "data-raw",
                         "EAD 3.0 Quarterly_11282023.dta")) %>% 
  mutate(year = floor(qtr/4 + 1960),
         quarter = qtr %% 4 * .25,
         year_quarter = year + quarter)

eapm0 <- rio::import(here("paper",
                         "korea",
                         "data-raw",
                         "EAD 3.0 Monthly_11282023.dta")) %>% 
  mutate(year = floor(monthly/12 + 1960),
         month = monthly %% 12, # 0 to 11
         year_month = year + month/12)
```

```{r eap_korea}
# Park is in office from 2013/02/09 to 2016/12/09
# Executive approval data for Feb 2013 seems to be for previous president, 
# so start with March (month 2 from 0 to 11)

caption <- "Source: Executive Approval Project (Carlin et al. 2025)"

eapm0 %>% 
  filter(country_name == "South Korea" &
           between(year_month, 2013+2/12, 2016+11/12)) %>% 
  mutate(approval_net = Approval_Not_Smoothed - Disapproval_Not_Smoothed) %>% 
  ggplot(aes(x = year_month, y = approval_net)) +
  theme_bw() +
  geom_point() +
  geom_line(linetype = "dotted") +
    theme(legend.position = "none") +
  coord_cartesian(xlim = c(2013, 2017.3)) +
  geom_hline(aes(yintercept = 0),
             color = "gray50",
             linetype = "dashed") +
  labs(x = NULL, y = "Net Presidential Approval,\nPark Geun-hye") +
  geom_text(data = tibble(year_month = 2016.4,
                          approval_net = -33),
            label = "Choi Soon-sil\nscandal breaks",
            size = 3) +
  geom_text(data = tibble(year_month = 2016.2,
                          approval_net = -53),
            label = "Candlelight protests spread",
            size = 3) +
  geom_text(data = tibble(year_month = 2017.2,
                          approval_net = -50),
            label = "Impeachment",
            size = 3) +
  # theme(axis.text.x  = element_text(size = 8,
  #                                   angle = 90,
  #                                   vjust = .45),
  #       plot.title = element_text(size=8)) + 
  plot_annotation(caption = str_wrap(caption, 90))


```


2017 election moved up to May; Moon wins five-way race with 41.1% of vote and a decisive 17.1% margin of victory 
<!-- https://en.wikipedia.org/wiki/2017_South_Korean_presidential_election -->

2022 election puts openly misogynistic Yoon Suk-yeol in office [@Kim2022a].  Backlash?



## Does the Election of a Women Chief Executive Spark a Backlash in the Public?

```{r pge}
pge_summary <- rio::import(here("data",
                                "pge_summary.rda"),
                           trust = TRUE) %>% 
  filter(country %in% oecd_countries)

pge <- rio::import(here("data",
                        "pge.rda"),
                   trust = TRUE) %>% 
  filter(country %in% oecd_countries)

```

```{r, fig.cap="PGE Scores in Korea During the Park Administration", fig.height=4}
#| label: fig-koreapge

caption <- "The pale shaded region indicate the years of Korea's first woman president, Park Geun-hye, from her election in 2013 to her impeachment and removal for corruption in 2016. Darker shading indicates the 80% credible interval of the PGE scores."

pge_summary %>% 
  filter(country == "South Korea") %>% 
  ggplot(aes(x = year, y = pge)) +
  theme_bw() +
  geom_rect(data = tibble(year = NA_integer_,
                          pge = NA_real_,
                          year_min = 2013,
                          year_max = 2016),
            aes(xmin = year_min, xmax = year_max, ymin = -Inf, ymax = Inf),
            fill = "gray95",
            color = "gray95",
            alpha = .6) +
  theme(legend.position = "none") +
  coord_cartesian(xlim = c(1990, 2020), ylim = c(0, 100)) +
  labs(x = NULL, y = "PGE Score") +
  geom_ribbon(aes(ymin = p10, ymax = p90,
                  linetype=NA),
              alpha = .2) +
  geom_line() +
  geom_text(data = tibble(year = 2014.5,
                          pge = 96),
            label = "Park\nAdministration",
            size = 4) +
  theme(axis.text.x  = element_text(size = 8,
                                    angle = 90,
                                    vjust = .45),
        plot.title = element_text(size=8)) + 
  plot_annotation(caption = str_wrap(caption, 90))
```

Did Park's success in winning the Blue House as Korea's first woman president cause a backlash in macroegalitarianism, public opinion toward gender equality in the public sphere?
@fig-koreapge plots the evolution of Korea's PGE scores before, during, and after Park's time in office.
The years during which Park held office are shaded in pale gray.
The PGE scores provide no clear evidence of a decline in gender egalitarian attitudes in Korea during these years.
When Park started her term in 2013, the country had a PGE score of 50.1 (80% credible interval: 46.2 to 52.2); when Park was removed from office in December 2016, Korea's PGE score was 51.3 (80% c.i.: 48.1 to 54.5).

But neither do these data show clear evidence of the _increase_ in macroegalitarianism that the cross-national results on women's legislative officeholding we presented in Chapter 4 would lead us to expect to occur during a time when the highest political office in the country was held by a woman. 
While estimated to be positive, the difference in PGE scores over these years---1.2 points---is not credibly different from zero (80% c.i.: -1.0 to 4.0).

```{r women_execs0, eval=FALSE}
pge_years <- pge_summary %>% 
  group_by(country) %>% 
  summarize(first_year = first(year),
            last_year = last(year))

women_execs00 <- rvest::read_html("https://en.wikipedia.org/wiki/List_of_elected_and_appointed_female_heads_of_state_and_government") %>% 
  rvest::html_table(fill=TRUE) %>% 
  first() %>% 
  janitor::clean_names() %>% 
  filter((str_detect(executiveor_non_executive, "Exec") |
            country == "Poland" & office == "Prime Minister") &
           country %in% oecd_countries) %>% 
  mutate(mandateend = case_when(mandateend == "Incumbent" ~
                              "4 August 2025",
                              str_detect(mandateend, "Suspended") ~
                                str_remove(mandateend, ".*Suspended "),
                              TRUE ~ mandateend),
         start_year = parse_date_time(mandate_start, "d m y") %>% 
           year(),
         start_quarter = (parse_date_time(mandate_start, "d m y") %>% 
           quarter() - 1) * .25,
         start_month = parse_date_time(mandate_start, "d m y") %>% 
           month(),
         start_day = parse_date_time(mandate_start, "d m y") %>% 
           day(),
         start_month = if_else(start_day > 15, start_month + 1, start_month),
         end_year = parse_date_time(mandateend, "d m y",
                                    quiet = TRUE) %>% 
           year(),
         end_quarter = (parse_date_time(mandateend, "d m y",
                                    quiet = TRUE) %>% 
           quarter() - 1) * .25,
         end_month = parse_date_time(mandateend, "d m y",
                                    quiet = TRUE) %>% 
           month(),
         end_day = parse_date_time(mandateend, "d m y",
                                    quiet = TRUE) %>% 
           day(),
         end_month = if_else(end_day < 15, end_month - 1, end_month)) %>%
  select(country, name, starts_with("start_"), starts_with("end_")) 

women_execs0 <- women_execs00 %>% 
  left_join(pge_years, by = "country") %>% 
  filter(!(start_year > last_year | end_year < first_year) &
           (end_year - start_year >= 1)) %>% 
  left_join(pge_summary, by = join_by(country == country,
                                      start_year == year)) %>% 
  rename(pge_start = pge,
         pge_start_se = pge_se) %>% 
  select(-matches("p\\d")) %>% 
  left_join(pge_summary, by = join_by(country == country,
                                      first_year == year)) %>% 
  mutate(pge_start = coalesce(pge_start, pge),
         pge_start_se = coalesce(pge_start_se, pge_se)) %>% 
  select(-pge, -pge_se, -matches("p\\d")) %>% 
  left_join(pge_summary, by = join_by(country == country,
                                      end_year == year)) %>% 
  rename(pge_end = pge,
         pge_end_se = pge_se) %>% 
  select(-matches("p\\d")) %>% 
  left_join(pge_summary, by = join_by(country == country,
                                      last_year == year)) %>% 
  mutate(name = iconv(name, "UTF-8", "UTF-8"),
         pge_end = coalesce(pge_end, pge),
         pge_end_se = coalesce(pge_end_se, pge_se),
         diff = pge_end - pge_start,
         diff_se = sqrt(pge_start_se^2 + pge_end_se^2)/2,
         t_val = diff/diff_se,
         p_val = pnorm(abs(t_val), lower.tail = FALSE)*2,
         start_yq = start_year + start_quarter,
         end_yq = end_year + end_quarter) %>% 
  select(-pge, -pge_se, -matches("p\\d|world")) %>% 
  arrange(diff)

rio::export(women_execs0, here("paper",
                               "korea",
                               "data",
                               "women_execs.rda"))
```

```{r women_execs}
pge_years <- pge_summary %>% 
  group_by(country) %>% 
  summarize(first_year = first(year),
            last_year = last(year))

women_execs <- rio::import(here("paper",
                               "korea",
                               "data",
                               "women_execs.rda"),
                           trust = TRUE)

women_execs_long <- women_execs %>%
  select(country, start_year, end_year) %>% 
  left_join(pge_years, by = "country") %>% 
  mutate(include = !(start_year > last_year | end_year < first_year) &
           (end_year - start_year >= 1)) %>%
  filter(include) %>% 
  expand_grid(year = min(pge_summary$year):max(pge_summary$year)) %>%
  transmute(country,
            year,
            women_exec = as.numeric(year >= start_year &
                                      year <= end_year &
                                      include == 1)) %>%
  group_by(country, year) %>%
  summarize(women_exec = as.logical(sum(women_exec)) %>%
              as.numeric(),
            .groups = "drop")

women_execs_long0 <- women_execs %>% 
  select(country, name, start_year, start_yq, end_year, end_yq) %>% 
  group_by(country, name) %>% 
  mutate(year_quarters = (end_yq - start_yq)*4)  %>% 
  uncount(year_quarters) %>% 
  ungroup() %>% 
  mutate(name = case_when(str_detect(name, "Bachelet") & start_year == 2006 ~
                            "Michelle Bachelet I",
                          str_detect(name, "Bachelet") & start_year == 2014 ~
                            "Michelle Bachelet II",
         TRUE ~ name)) %>% 
  group_by(country, name, start_year) %>% 
  mutate(year = start_yq + (row_number() - 1)/4, 
         name2 = case_when(str_detect(name, "Thatcher") &
                            between(year, 1979.25, 1982.25) ~
                            "Margaret Thatcher I",
                          str_detect(name, "Thatcher") &
                            between(year, 1982.5, 1986.25) ~
                            "Margaret Thatcher II",
                          str_detect(name, "Thatcher") &
                            between(year, 1986.5, 1990.5) ~
                            "Margaret Thatcher III",
                          str_detect(name, "Clark") &
                            between(year, 1999.75, 2002.25) ~
                            "Helen Clark I",
                          str_detect(name, "Clark") &
                            between(year, 2002.5, 2005.5) ~
                            "Helen Clark II",
                          str_detect(name, "Clark") &
                            between(year, 2005.75, 2008.5) ~
                            "Helen Clark III",
                          str_detect(name, "Solberg") &
                            between(year, 2013.75, 2017.5) ~
                            "Erna Solberg I",
                          str_detect(name, "Solberg") &
                            between(year, 2017.75, 2021.5) ~
                            "Erna Solberg II",
                          str_detect(name, "Ardern") &
                            between(year, 2017.75, 2020.5) ~
                            "Jacinda Ardern I",
                          str_detect(name, "Ardern") &
                            between(year, 2020.75, 2023.25) ~
                            "Jacinda Ardern II",
                          str_detect(name, "Brundtland") &
                            between(year, 1990.75, 1993.5) ~
                            "Gro Harlem Brundtland III",
                          str_detect(name, "Brundtland") &
                            between(year, 1993.75, 1996.5) ~
                            "Gro Harlem Brundtland IV",
                          str_detect(name, "Merkel") &
                            between(year, 2005.75, 2009.5) ~
                            "Angela Merkel I",
                          str_detect(name, "Merkel") &
                            between(year, 2009.75, 2013.5) ~
                            "Angela Merkel II",
                          str_detect(name, "Merkel") &
                            between(year, 2013.75, 2017.75) ~
                            "Angela Merkel III",
                          str_detect(name, "Merkel") &
                            between(year, 2018, 2021.5) ~
                            "Angela Merkel IV",
                          str_detect(name, "May") &
                            between(year, 2016.5, 2017.25) ~
                            "Theresa May I",
                          str_detect(name, "May") &
                            between(year, 2017.5, 2019.25) ~
                            "Theresa May II",
         TRUE ~ name),
         year_quarter = year,
         year = floor(year_quarter)) %>%
  ungroup() %>% 
  select(country, name, name2, year, year_quarter) 

women_execs1 <- women_execs_long0 %>% 
  group_by(country, name2) %>% 
  filter(year == first(year) | year == last(year)) %>% 
  select(-year_quarter) %>% 
  distinct()

pge_diff <- pge %>%
  split(pge$draw) %>%
  map(~.x %>%
        right_join(women_execs1,
                   by = join_by(country, year)) %>% 
        group_by(country, name2) %>% 
        summarize(diff0 = last(pge) - first(pge),
                  .groups = "keep")) %>% 
  list_rbind() %>% 
  summarize(diff = mean(diff0, na.rm = TRUE),
         diff_se = sd(diff0, na.rm = TRUE),
         diff_p10 = quantile(diff0, probs = .1, na.rm = TRUE),
         diff_p90 = quantile(diff0, probs = .9, na.rm = TRUE),
         .groups = "drop") %>% 
  filter(!is.na(diff) & !diff == 0) %>% 
  arrange(-diff)

women_execs_long1 <- women_execs_long0 %>%
  inner_join(pge_diff,
            by = join_by(country, name2)) %>%
  left_join(eapq0 %>% 
              transmute(country = if_else(country_name == "Poland_PM",
                                          "Poland",
                                          country_name),
                        year_quarter,
                        approval = Approval_Not_Smoothed,
                        disapproval = Disapproval_Not_Smoothed,
                        approval_net = approval - disapproval),
            by = join_by(country, year_quarter))

```

```{r, fig.cap="Trends in Macroegalitarianism in OECD Countries That Have Had Women Leaders", fig.height=9, dev='cairo_pdf'}
#| label: fig-pge_women_execs

# Trend in PGE in countries other than Korea that have had women chief executives, ordered by change in PGE during mandate

caption <- "Notes: The pale shaded regions in the plots on the left-hand side indicate the years during which women served as chief executives in these countries. Darker shading (in the plots to the left) and the whiskers (in the plot to the right) indicate the 80% credible interval of the PGE scores."

pge_women_execs <- pge_summary %>% 
  filter(country %in% pge_diff$country &
           !country == "South Korea" &
           !country == "Lithuania") %>%
  ggplot() +
  geom_rect(aes(xmin = start_yq, xmax = end_yq),
            fill = "grey70",
            ymin = -Inf, ymax = Inf, alpha = 0.2,
            data = women_execs %>% 
              filter(!country == "South Korea" &
                       !country == "Lithuania")) +
  geom_line(aes(x = year, y = pge)) +
  geom_ribbon(aes(x = year, ymin = p10, ymax = p90), 
              alpha = .2) +
  facet_wrap(. ~ factor(country, levels = unique(pge_diff$country)),
             ncol = 2) +
  labs(x = NULL, y = NULL) +
  theme_bw() +
  theme(strip.background = element_blank(),
        axis.text.x  = element_text(size = 8,
                                    angle = 90,
                                    vjust = .45),
        plot.title = element_text(size=8)) + 
  ggtitle("Trends in PGE Scores\nin OECD Countries\nOver Women Leaders' Terms") +
  plot_annotation(caption = str_wrap(caption, 90))

trends_women_execs <- pge_diff %>% 
  mutate(name3 = paste0(name2 %>% 
                          str_remove("^\\S+( Harlem)?") %>% 
                          str_replace("Geun-hye", "Park"),
                        " (", 
                        countrycode(country,
                                    "country.name",
                                    "iso2c"),
                        ")")) %>% 
  mutate(name3 = as_factor(name3) %>% 
           fct_reorder(-diff)) %>% 
  ggplot(aes(x = diff, y = name3)) +
  geom_segment(aes(x = diff_p10,
                   xend = diff_p90,
                   y = name3,
                   yend = name3),
               na.rm = TRUE,
               alpha = .4) +
  geom_vline(xintercept = 0,
             linetype = "dashed",
             alpha = .25) +
  geom_point(fill = "black", shape = 21, size = .5, na.rm = TRUE) +
  theme_bw() + 
  theme(legend.position="none",
        # axis.text.x  = element_text(size = 9,
        #                             angle = 0,
        #                             vjust = .45,
        #                             hjust = .95),
        axis.text.y  = element_text(size = 9),
        axis.title = element_blank(),
        strip.background = element_blank(), 
        strip.text = element_blank(),
        panel.grid.major = element_line(linewidth = .3),
        panel.grid.minor = element_line(linewidth = .15),
        plot.title = element_text(size=8)) +
  scale_y_discrete(limits = rev) +
  ggtitle("Change in PGE Scores\nFrom First to Last Year\nof Women Leaders' Terms") +
  plot_annotation(caption = str_wrap(caption, 90))

pge_women_execs + trends_women_execs

```

Looking more broadly across the OECD allows us another opportunity to test the hypothesis that women chief executives, in contrast to the legislators we examined in Chapter 4, trigger public opinion backlash. 
Although women's successes in winning the chief executive's office remain decidedly the exception rather than the rule, they have been growing more frequent over time across these countries.
Including Park, our dataset includes PGE scores during the time in office of 21 women leaders who governed in Korea and fourteen other OECD countries.
Trends in macroegalitarianism in these additional countries are depicted on the left side of @fig-pge_women_execs.^[
Israel, where Golda Meir was prime minister from 1969 to 1974, and Portugal, where Maria de Lourdes Pintasilgo was prime minister from 1979 to 1980, are excluded from the figure because these terms in office predate our earliest PGE scores for those countries.
Because the PGE scores are measured at the annual level, Kim Campbell's four-month term as Canada's prime minister in 1993 and Anneli Jäätteenmäki's two months as Finland's prime minister in 2003 are too short to observe changes in this variable; these leaders' terms are excluded as well.
A number of additional OECD countries have elected women chief executives after the last year for which data on macroegalitarianism is currently available.
Regrettably, we cannot include these leaders either.]
The pale gray rectangles indicate the years during which a woman served as chief executive in each of these countries.

The right side of @fig-pge_women_execs shows how attitudes toward gender equality in the public sphere changed over the terms in office of women chief executives in the OECD for which we have PGE scores.
During these `r nrow(pge_diff)` terms in office, the change is estimated to be positive---that is, macroegalitarianism was higher at the end of the term than at its start---more than twice as often (`r nrow(pge_diff %>% filter(diff > 0))` times) as it is negative (`r nrow(pge_diff %>% filter(diff < 0))` times).
Calculating the difference between two quantities measured with uncertainty results in even more uncertainty, however: only `r nrow(pge_diff %>% filter(diff_p10 > 0))` of these changes are credibly positive with 80% confidence.
On the other hand, the 80% credible intervals indicate that none of the changes with negative point estimates are credibly different from zero. 
Taken as a whole, then, the evidence from the PGE scores does not support the hypothesis that the mere election of a woman to a country's highest office works to trigger a backlash against gender equality among the public. 



\pagebreak
### By Item

```{r korea_data0, eval=FALSE}
korea_data0 <- read_csv(here("paper",
                             "korea",
                             "data-raw",
                             "korea_surveys.csv"),
                        col_types = "cccccccc") %>% 
  survey_setup() %>% 
  filter(country == "South Korea") %>% 
  filter(between(age, 18, 98))

rio::export(korea_data0, 
            here("paper",
                 "korea",
                 "data",
                 "korea_data0.RData"))
```

```{r korea_data1, eval=FALSE}
korea_data0 <- rio::import(here("paper",
                                "korea",
                                "data",
                                "korea_data0.RData"))

korea_data1 <- korea_data0 %>% 
  remove_val_labels() %>% 
  pivot_longer(cols = politics4:equalright4,
               names_to = "item") %>% 
  filter(!is.na(value) & !(str_detect(item, "5$") & year==2018)) %>% 
  mutate(item_year = paste(item, year),
         gender = factor(female, 
                         levels = c(0, 1),
                         labels = c("Men", "Women")),
         year_birth = year - age,
         gen = factor(case_when(year_birth <= 1965 ~ "Boomer",
                         between(year_birth, 1966, 1981) ~ "GenX",
                         year_birth >= 1982 & !year_birth==9999 ~ "GenMZ"),
                      levels = c("Boomer", "GenX", "GenMZ")),
         uni = factor(if_else(university == 1, "Uni", "No Uni")),
         gen_gen_edu = factor(gender:gen:uni),
         gge = as.numeric(factor(gen_gen_edu)))

rio::export(korea_data1, 
            here("paper",
                 "korea",
                 "data",
                 "korea_data1.RData"))
```

```{r load_data}
korea_data1 <- rio::import(here("paper",
                                "korea",
                                "data",
                                "korea_data1.RData"))

korea_questions <- read_csv(here("paper",
                                 "korea",
                                 "data-raw",
                                 "korea_questions.csv"),
                            col_types = "cc") %>% 
  mutate(item_type = if_else(str_detect(item, "poli|^equal"),
                             "Politics",
                             "Workplace"))

```

```{r kd1_means_all}
kd1_means_all <- korea_data1 %>% 
  group_by(item, year) %>% 
  summarize(mean = mean(value),
            se = sd(as.numeric(value), na.rm = TRUE)/sqrt(n()),
            low = mean - qnorm(.915)*se, #83% ci for 95% stat.sig. difference
            hi = mean + qnorm(.915)*se,
            .groups = "drop_last") %>% 
  mutate(n = n()) %>% 
  ungroup() %>% 
  filter(!item == "income4") %>% 
  arrange(-n) %>% 
  left_join(korea_questions,
            by = join_by(item)) %>% 
  mutate(q = fct_reorder(question, n, .desc = TRUE))

```

```{r kd1_means}
kd1_means <- map(c("gender", "gen", "uni"), function(var) {
    korea_data1 %>%
      group_by(year, item, .data[[var]]) %>% 
      summarize(mean = mean(value),
                se = sd(as.numeric(value), na.rm = TRUE)/sqrt(n()),
                low = mean - se*1.372204, #83% ci for 95% stat.sig. difference
                hi = mean + se*1.372204,
                .groups = "drop")
  }) %>% 
  list_rbind() %>% 
  pivot_longer(cols = c("gender", "gen", "uni"),
               names_to = "variable") %>% 
  filter(!is.na(value)) %>% 
  group_by(item) %>% 
  mutate(variable = factor(variable,
                      levels = c("gender", "gen", "uni"),
                      labels = c("Gender", "Generation", "Education")),
         n = n()) %>%
  ungroup() %>% 
  filter(!item == "income4" & se < .3) %>% 
  left_join(korea_questions, by = "item") %>% 
  mutate(q = fct_reorder(question, n, .desc = TRUE))
```

```{r, fig.cap="Trends in Mean Responses to Survey Items on Gender Equality in Korea", fig.height = 9}
#| label: fig-kd1allplot1

caption <- "All survey items are coded so that more egalitarian responses have higher values. The shaded region indicates the years of Korea's first woman president, Park Geun-hye, from her election in 2013 to her impeachment and removal for corruption in 2016."

kd1_poli_summary <- kd1_means_all %>% 
              filter(item_type == "Politics") %>% 
              mutate(q = fct_reorder(question, n, .desc = TRUE)) %>% 
  group_by(q) %>% 
  summarize(year_min = 2013,
            year_max = 2016,
            mean = mean(mean))

kd1_work_summary <- kd1_means_all %>% 
              filter(item_type == "Workplace") %>% 
              mutate(q = fct_reorder(question, n, .desc = TRUE)) %>% 
  group_by(q) %>% 
  summarize(year_min = 2013,
            year_max = 2016,
            mean = mean(mean))

poli_all <- kd1_means_all %>%
  filter(item_type == "Politics") %>% 
  mutate(q = fct_reorder(question, n, .desc = TRUE)) %>% 
  ggplot() +
  geom_rect(data = kd1_poli_summary,
            aes(xmin = year_min, xmax = year_max, ymin = -Inf, ymax = Inf),
            fill = "gray95",
            color = "gray95",
            alpha = .6) +
  geom_pointrange(aes(x = year, y = mean, ymin = low, ymax = hi),
                  fatten = 1, 
                  alpha = .5) +
  geom_line(aes(x = year, y = mean),
            linetype = "dotted") +
  facet_grid(q ~ item_type,
             scales = "free_y",
             switch = "y",
             labeller = label_wrap_gen(31)) +
  theme_bw() +
  theme(legend.position="none",
        strip.background = element_blank(),
        strip.text.y.left = element_text(angle = 0),
        axis.text.x = element_text(angle = 90)) +
  scale_x_continuous(limits = c(1995, 2026),
                     breaks = seq(1995, 2025, by = 5),
                     labels = seq(1995, 2025, by = 5)) +
  scale_y_continuous(position = "right") +
  labs(x = NULL, y = NULL)

work_all <- kd1_means_all %>%
  filter(item_type == "Workplace") %>% 
  mutate(q = fct_reorder(question, n, .desc = TRUE)) %>% 
  ggplot() +
  geom_rect(data = kd1_work_summary,
            aes(xmin = year_min, xmax = year_max, ymin = -Inf, ymax = Inf),
            fill = "gray95",
            color = "gray95",
            alpha = .6)  +
  geom_pointrange(aes(x = year, y = mean, ymin = low, ymax = hi),
                  fatten = 1, 
                  alpha = .5) +
  geom_line(aes(x = year, y = mean),
            linetype = "dotted") +
  facet_grid(q ~ item_type,
             scales = "free_y",
             # switch = "y",
             labeller = label_wrap_gen(31)) +
  theme_bw() +
  theme(legend.position="none",
        strip.background = element_blank(),
        strip.text.y.right = element_text(angle = 0),
        axis.text.x = element_text(angle = 90)) +
  scale_x_continuous(limits = c(1995, 2026),
                     breaks = seq(1995, 2025, by = 5),
                     labels = seq(1995, 2025, by = 5)) +
  # scale_y_continuous(position = "right") +
  labs(x = NULL, y = NULL)

layout <- c(
  area(t = 1, l = 1, b = 697, r = 2),
  area(t = 1, l = 3, b = 1000, r = 4)
)

poli_all + work_all + 
  plot_layout(design = layout) + 
  plot_annotation(caption = str_wrap(caption, 90))
```

One advantage of our focus on Korea in this chapter is that it allows us to look at individual survey items in ways that are not possible when taking the broad comparative vantage that we adopted earlier in the book.
@fig-kd1allplot1 displays the trends of mean responses to the survey questions on gender egalitarianism that were used to create the PGE scores for Korea, with the items regarding equality in politics in the left column and those on equality in the workplace on the right.
The years that Park held the presidency, 2013--2016, are again shaded in pale gray.
Among the questions on equality in politics, all but one suggest a decline during Park's term; among the questions on equality in the workplace, all but one do _not_ evince a decline during those years.

Before exploring further, it is worth pausing a moment to remember that this pattern is distinctly atypical.
Remember, we found in Chapter 3 that public opinion about equality in politics and in the workplace are typically tightly bound to each other (see, for example, @fig-pge_pwe_corr_plot).
That they are not in this case suggests that something unusual---and so interesting---is going on.

We also pause to note that the two exceptions appear upon closer examination to be perhaps not that exceptional.
With regard to political equality, the only item that intersects with Park's years in office that shows an increase is "in general, men and women make equally good political leaders."
The upswing in agreement with this item, however, is evidenced only in 2023, some seven years after Park was replaced in office and at least four years later than the last observations of the other political-equality items.^[
Indeed, the survey on which this observation is based, Pew Research Center's 2023 East Asian Societies Survey, was so much later that its release was too recent for it to be included in the PGE scores employed in this book.]
And with regard to equality in the workplace, the only item for which egalitarian responses declined over Park's term was "men make better business leaders than women," which is also the only workplace item that implicates women's leadership.
It would seem on the basis of this evidence that Park's presidency negatively affected the Korean public's views of women in positions of power, if only in the short run.

```{r surveys_oecd_political, cache=TRUE}
dcpo_input_raw_pge <- read_csv(here("paper",
                                    "measuring_egalitarianism",
                                    "data",
                                    "dcpo_input_raw_pge.csv"),
                               col_types = "cdcddcd")

process_dcpo_input_raw <- function(dcpo_input_raw_df) {
  dcpo_input_raw_df %>% 
    with_min_yrs(2) %>% 
    with_min_cy(5) %>% 
    filter(year >= 1972) %>% 
    group_by(country) %>% 
    mutate(cc_rank = n()) %>% 
    ungroup() %>% 
    arrange(-cc_rank)
} 

surveys_oecd <- process_dcpo_input_raw(dcpo_input_raw_pge) %>%
  filter(country %in% oecd_countries)

public_items <- read_csv(here::here("paper",
                                    "measuring_egalitarianism",
                                    "data-raw",
                                    "public_items.csv"),
                         col_types = "ccddd")

surveys_oecd_political <- surveys_oecd %>%
  inner_join(public_items, by = "item") %>% 
  filter(political == 1 & 
           country %in% women_execs$country &
           !country == "South Korea") %>% 
  group_by(country, item, year) %>% 
  summarize(mean = sum(r*n)/sum(n),
            se = (sqrt(sum(n*(r-mean)^2)/(sum(n) - 1)))/sqrt(sum(n)),
            low = mean - qnorm(.9)*se,
            hi = mean + qnorm(.9)*se,
            question_text = first(question_text)) %>% 
  mutate(n = n()) %>% 
  filter(n >= 2 & 
           ((country == "Slovakia" & item == "unqualified4") |
              (country == "Chile" & item == "politicianecon3") |
              (country == "Poland" & item == "equalright4b") |
              (country == "United Kingdom" & 
                 item %in% c("equalright4b", "politics4a")) |
              (!country == "Latvia" & item == "polileader4"))) %>% 
  mutate(item_text = case_when(item == "polileader4" ~
                                 "Men make better political leaders than women do (reversed)",
                               item == "equalright4b" ~
                                 "How important is it to have this in our country? Women have the same rights as men",
                               item == "politics4a" ~
                                 "Politics should be left to men (reversed)",
                               item == "politicianecon3" ~
                                 "If a politician is responsible for running the national economy, who would do a better job, a man or a woman or does it not matter?",
                               item == "unqualified4" ~
                                 "Women do not always have the necessary qualities and skills to fill positions of responsibility (reversed)"),
         last_mean = last(mean)) %>%
  group_by(item) %>% 
  mutate(item_n = n()) %>% 
  ungroup() %>% 
  left_join(women_execs %>% 
              select(country, start_yq, end_yq)) %>% 
  arrange(-item_n, -last_mean) %>% 
  mutate(country = fct_inorder(country))
```

```{r, fig.cap="Trends in Mean Survey Responses on Gender Equality in Politics in OECD Countries That Have Had Women Chief Executives"}
#| label: fig-xc_polileader4

caption <- "Pale shaded regions indicate the years during which women served as chief executives in each country."

surveys_oecd_political %>% 
  filter(item == "polileader4") %>% 
  ggplot() +
  geom_rect(aes(xmin = start_yq, xmax = end_yq),
            fill = "grey70",
            ymin = -Inf, ymax = Inf, alpha = 0.2,
            data = surveys_oecd_political %>% 
              filter(item == "polileader4") %>% 
              select(country, ends_with("_yq")) %>% 
              distinct()) +
  geom_pointrange(aes(x = year, y = mean, ymin = low, ymax = hi),
                  fatten = 1, 
                  alpha = .5) +
  geom_line(aes(x = year, y = mean),
            linetype = "dotted") +
  facet_wrap(vars(country),
             nrow = 3,
             labeller = label_wrap_gen(31)) +
  theme_bw() +
  theme(strip.background = element_blank(),
        axis.text.x  = element_text(size = 8,
                                    angle = 90,
                                    vjust = .45),
        plot.title = element_text(size=8),
        axis.title.y.right = element_blank()) +   
  scale_y_continuous(position = "right",
                     sec.axis = dup_axis()) +
  labs(x = NULL, 
       y = "Men make better political leaders\nthan women do (reversed)") +
   plot_annotation(caption = str_wrap(caption, 90))
```

To help figure out what that might be, we first turn to other countries that have had women chief executives.
@fig-xc_polileader4 shows how mean disagreement with the statement "men make better political leaders than women" changed over time in the eleven countries for which these series intersected with the terms of women chief executives.
These data are very thin---recall that in Chapter 3, we explained that the sparsity of the existing data was an important motivation for creating the PGE scores---but they show very little evidence of declines during the years in which women held office.^[
Among the surveys we used in Chapter 3 to generate the PGE scores, there are five other country-items asking about gender equality in politics that intersect with the time in office of women chief executives: three items of one country each, and a fourth with two countries.
All but one of these country-item series consist of just two time points, and the other has only three.
None of these five very short series exhibit discernibly declining levels of gender egalitarianism in the public during women's terms as chief executive.]
There is one exception to this rule: Michelle Bachelet's second term as president of Chile.





### Polarization: By Item, By Demografic

```{r, fig.cap="Trends in Mean Responses to Survey Items on Gender Equality in Politics by Demographic Groups in Korea", fig.height = 9}
#| label: fig-kd1mplot1

caption <- "All survey items are coded so that more egalitarian responses have higher values. The shaded region indicates the years of Korea's first woman president, Park Geun-hye, from her election in 2013 to her impeachment and removal for corruption in 2016."

annote_text <- tibble(
  q = factor(levels(kd1_means %>% 
                      filter(item_type == "Politics") %>% 
                      pull(q) %>% 
                      fct_drop())[4], 
  levels = levels(kd1_means %>% 
                    filter(item_type == "Politics") %>% 
                    pull(q) %>%
                    fct_drop())),
  variable = factor(c("Gender", "Gender",
                      "Generation", "Generation", "Generation",
                      "Education", "Education"),
                    levels = c("Gender", "Generation", "Education"),
                    labels = c("Gender", "Generation", "Education")),
  value = factor(levels(kd1_means$value),
                 levels = levels(kd1_means$value)),
                 label = levels(kd1_means$value),
  year = c(2003.25, 2001.5, # politics plot
           2001.75, 2002.25, 2001.75,
           2002, 2003),
  mean = c(1.71, 1.87,
           1.71, 1.84, 1.92,
           1.77, 1.82))

kd1_means %>%
  filter(item_type == "Politics") %>% 
  ggplot() +
  geom_rect(data = kd1_poli_summary,
            aes(xmin = year_min, xmax = year_max, ymin = -Inf, ymax = Inf),
            fill = "gray95",
            color = "gray95",
            alpha = .6) +
  geom_text(data = annote_text,
            aes(x = year, y = mean, label = label, color = value),
            size = 3,
            alpha = .9) +
  geom_pointrange(aes(x = year, y = mean, ymin = low, ymax = hi, color = value),
                  fatten = 1, 
                  alpha = .5) +
  geom_line(aes(x = year, y = mean, color = value),
            linetype = "dotted") +
  facet_grid(q ~ variable,
             scales = "free_y",
             switch = "y",
             labeller = label_wrap_gen(31)) +
  theme_bw() +
  theme(legend.position="none",
        strip.background = element_blank(),
        strip.text.y.left = element_text(angle = 0),
        axis.text.x = element_text(angle = 90)) +
  scale_x_continuous(limits = c(1995, 2026),
                     breaks = seq(1995, 2025, by = 5),
                     labels = seq(1995, 2025, by = 5)) +
  scale_y_continuous(position = "right") +
  labs(x = NULL, y = NULL) +
  scale_color_manual(values = c("Men" = "grey65",
                                "Women" = "grey30",
                                "Boomer" = "grey65",
                                "GenX" = "grey50",
                                "GenMZ" = "grey30",
                                "No Uni" = "grey65",
                                "Uni" = "grey30"),
                     aesthetics = c("colour", "fill"))  +
  plot_annotation(caption = str_wrap(caption, 120))

```

```{r, fig.cap="Trends in Mean Responses to Survey Items on Gender Equality in the Workplace by Demographic Groups in Korea", fig.height = 9}
#| label: fig-kd1mplot2

annote_text <- tibble(
  q = factor(levels(kd1_means %>% 
                      filter(!item_type == "Politics") %>% 
                      pull(q) %>% 
                      fct_drop())[6], 
  levels = levels(kd1_means %>% 
                    filter(!item_type == "Politics") %>% 
                    pull(q) %>%
                    fct_drop())),
  variable = factor(c("Gender", "Gender",
                      "Generation", "Generation", "Generation",
                      "Education", "Education"),
                    levels = c("Gender", "Generation", "Education"),
                    labels = c("Gender", "Generation", "Education")),
  value = factor(levels(kd1_means$value),
                 levels = levels(kd1_means$value)),
  label = levels(kd1_means$value),
  year = c(2006, 2004.5,  # workplace plot
           2005, 2005.5, 2005,
           2005, 2007),
  mean = c(2.15, 2.4,
           2.15, 2.33, 2.5,
           2.2, 2.33))

kd1_means %>%
  filter(!item_type == "Politics") %>% 
  ggplot() +
  geom_rect(data = kd1_work_summary,
            aes(xmin = year_min, xmax = year_max, ymin = -Inf, ymax = Inf),
            fill = "gray95",
            color = "gray95",
            alpha = .6) +
  geom_text(data = annote_text,
            aes(x = year, y = mean, color = value, label = label),
            size = 3,
            alpha = .9) +
  geom_pointrange(aes(x = year, y = mean, 
                      ymin = low, ymax = hi,
                      color = value),
                  fatten = 1, 
                  alpha = .4) +
  geom_line(aes(x = year, y = mean, color = value),
            linetype = "dotted") +
  facet_grid(q ~ variable,
             scales = "free_y",
             switch = "y",
             labeller = label_wrap_gen(31)) +
  theme_bw() +
  theme(legend.position="none",
        strip.background = element_blank(),
        strip.text.y.left = element_text(angle = 0),
        axis.text.x = element_text(angle = 90)) +
  scale_x_continuous(limits = c(1995, 2026),
                     breaks = seq(1995, 2025, by = 5),
                     labels = seq(1995, 2025, by = 5)) +
  scale_y_continuous(position = "right") +
  labs(x = NULL, y = NULL) +
  scale_color_manual(values = c("Men" = "grey70",
                                "Women" = "grey30",
                                "Boomer" = "grey70",
                                "GenX" = "grey50",
                                "GenMZ" = "grey30",
                                "No Uni" = "grey70",
                                "Uni" = "grey30"),
                     aesthetics = c("colour", "fill"))  +
  plot_annotation(caption = str_wrap("Shaded region indicates the years of Korea's first woman president, Park Geun-hye, from her election in 2013 to her impeachment and removal for corruption in 2016", 120))

```



## Executive Approval

Re Theresa May @Rifkin2018


```{r, fig.cap="Macroegalitarianism and Executive Approval by Term for Women Chief Executives", fig.height=9, cache=FALSE, dev='cairo_pdf'}
#| label: fig-pge_eap

pge_eap <- pge %>% 
  split(pge$draw) %>% 
  map(. %>% right_join(women_execs_long1 %>% 
                         ungroup() %>% 
                         mutate(name2 = str_extract(name2,
                                                   "[A-Z][a-złóðáč-]*[A-Z]?[a-z]* ?I*V?$") %>% 
                                  str_replace("Geun-hye", "Park")) %>% 
                         select(country, year, name2, approval_net), 
                       by = c("country", "year")) %>%
        group_by(country, name2) %>% 
        summarize(pge_diff = (last(pge) - first(pge)),
                  approval_net_mean = mean(approval_net),
                  .groups = "drop") %>% 
        ungroup() %>% 
        filter(complete.cases(.)))


pge_eap_cor <- map(pge_eap,
                   function(x) with(x, 
                                    cor(pge_diff, approval_net_mean,
                                        use = "pairwise.complete.obs"))) %>% 
  unlist() %>% 
  mean() %>% 
  round(2) %>% 
  paste0("R = ", .)

pge_eap_label <- tibble(pge_diff = 12,
                        approval_net_mean = -30,
                        label = pge_eap_cor)

pge_eap1 <- pge_eap %>% 
  list_rbind() %>% 
  group_by(country, name2) %>% 
  summarize(pge_diff_p10 = quantile(pge_diff, probs = .1),
            pge_diff_p90 = quantile(pge_diff, probs = .9),
            pge_diff = mean(pge_diff),
            approval_net_mean = mean(approval_net_mean),
            .groups = "drop") 

caption = "Note: Whiskers represent 80% credible intervals."

pge_eap1 %>% 
  ggplot(aes(y = pge_diff,
             x = approval_net_mean)) +
  geom_smooth(method = 'lm',
              formula = 'y ~ x',
              se = FALSE) +
  geom_text(aes(label = name2),
            size = 2.5) +
  geom_segment(aes(y = pge_diff_p10,
                   yend = pge_diff_p90),
               alpha = .2) +
  theme_bw() +
  labs(x = "Mean Net Executive Approval", 
       y = "Change in PGE Score") + 
  ggtitle("Approval of Women Chief Executives and\nChange in PGE Scores") +
  geom_label(data = pge_eap_label, aes(label = label), size = 3) +
  plot_annotation(caption = caption)

```

The bivariate relationship between the change in PGE scores during a term of a woman chief executive and her mean net approval during that term is displayed in @fig-pge_eap.
Even with the large uncertainties in the change in PGE scores and the limited number of observations---executive approval data is only available for 23 terms of women chief executives in the Executive Approval Project dataset---the positive relationship is still evident.
High positive net approval ratings for women chief executives are associated with increases over their terms in the public's gender egalitarian attitudes.
Negative net approval ratings are associated with flat or declining macroegalitarianism.

https://statmodeling.stat.columbia.edu/2017/02/06/not-kill-statistical-significance-makes-stronger-fallacy/



> heteroskedasticity here? incorporate legislatures somehow