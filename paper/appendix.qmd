# Appendices

\setcounter{figure}{0}
\renewcommand{\thefigure}{A\arabic{figure}}
\setcounter{table}{0}
\renewcommand{\thetable}{A\arabic{table}}

```{r setup, include=FALSE}
options(tinytex.verbose = TRUE)

knitr::opts_chunk$set(
  echo = FALSE,
  message = FALSE,
  warning = FALSE,
  cache = TRUE,
  dpi = 1000,
  fig.width = 7.5,
  fig.height = 4
)

# If `DCPOtools` is not yet installed:
# remotes::install_github("fsolt/DCPOtools")

# If development version of `DCPO` is not yet installed:
# remotes::install_github("fsolt/DCPO")

library(DCPOtools)
library(DCPO)
library(tidyverse)
library(glue)
library(countrycode)
library(patchwork)
library(modelsummary)
library(here)

set.seed(324)

oecd_countries <- c("Australia", "Austria", "Belgium",
                    "Canada", "Chile", "Colombia",
                    "Costa Rica", "Czechia", "Denmark",
                    "Estonia", "Finland", "France", 
                    "Germany", "Greece", "Hungary",
                    "Iceland", "Ireland", "Israel",
                    "Italy", "Japan", "South Korea",
                    "Latvia", "Lithuania", "Luxembourg",
                    "Mexico", "Netherlands", "New Zealand",
                    "Norway", "Poland", "Portugal", 
                    "Slovakia", "Slovenia", "Spain",
                    "Sweden", "Switzerland", "Turkey", 
                    "United Kingdom", "United States")
```

\pagebreak
## Appendix A: Sample of Published Articles on Public Opinion Toward Gender Equality

To generate a sample of published articles on gender egalitarianism, we searched the Web of Science.
Web of Science topic searches return articles in which the search terms appear in the title or abstract.
We executed the following search: `TS = (("public opinion" OR attitudes OR culture) AND ((women* OR gender) AND (equal* OR egalitarian*)))`.
After filtering the many false positives---articles that do not include a measure of public attitudes toward gender equality or gender roles---the hundred most cited empirical research articles returned compose our sample.
Each of the articles was then consulted to identify its number of countries and mean years observed per country.
This information is listed in Table A1 below.

\pagebreak
\noindent Table A1: Prominent Research Articles on Public Opinion Toward Gender Roles
```{r articles_table}
gr <- read_csv(here("paper",
                    "introduction",
                    "data-raw",
                    "wos_gr.csv"),
               show_col_types = FALSE) %>% 
  janitor::clean_names() %>% 
  mutate(year = publication_year,
         hits = times_cited_all_databases,
         last_names = str_remove_all(authors, ", [A-Z]{1,3}") %>% 
           str_to_title() %>% 
           str_replace_all(";", ",") %>% 
           {ifelse(str_count(., ",") > 1,
                   str_replace(., ",.*", " et al."),
                   .)} %>% 
           str_replace(", ([A-Z][a-z]+)$", ", and \\1") %>%
           str_replace("^([A-Z][a-z]+(?:-[A-Z][a-z]+)?), and ([A-Z][a-z]+)$", "\\1 and \\2") %>% 
           str_replace("Thornton, ", "Thornton and ") %>% 
           str_replace("Pedula, ", "Pedula and "),
         citation = paste(last_names, year),
         k = if_else(k == 13.5, k, round(k)),
         t = round(t, 1),
         cy = k*t)

gr %>% 
  arrange(-hits) %>% 
  transmute(Article = citation,
            `Countries Observed` = as.character(k),
            `Mean Years Observed per Country` = as.character(round(t, 1)),
            `Country-Years Observed` = as.character(round(cy)) %>%
              str_trim(),
            `WoS Citations` = as.character(hits)) %>% 
  modelsummary::datasummary_df(output = "kableExtra",
                               longtable = TRUE) %>%
  kableExtra::column_spec(1, width = "14em") %>%
  kableExtra::column_spec(c(2, 3, 4, 5), width = "6em") %>%
  kableExtra::kable_styling(font_size = 10) %>%
  kableExtra::kable_styling(latex_options = c("repeat_header")) # %>%
  # kableExtra::kable_styling(latex_options = "striped")
```


\pagebreak

## Appendix B: Survey Items Used to Estimate Public Gender Egalitarianism
```{r item_summary, cache = FALSE, cache.extra = tools::md5sum(here::here("data-raw", "dcpo_input_raw_public.csv"))}
surveys_pge <- read_csv(here("paper",
                             "measuring_egalitarianism",
                             "data-raw",
                             "surveys_pge.csv"),
                        col_types = "cccccnn")

dcpo_input_raw_pge <- read_csv(here("paper",
                                    "measuring_egalitarianism",
                                    "data",
                                    "dcpo_input_raw_pge.csv"),
                               col_types = "cdcddcd")

load(here::here("data", "item_results.rda"))

process_dcpo_input_raw <- function(dcpo_input_raw_df) {
  dcpo_input_raw_df %>% 
    with_min_yrs(2) %>% 
    with_min_cy(5) %>% 
    filter(year >= 1972) %>% 
    group_by(country) %>% 
    mutate(cc_rank = n()) %>% 
    ungroup() %>% 
    arrange(-cc_rank)
} 

dcpo_input_raw_pge1 <- process_dcpo_input_raw(dcpo_input_raw_pge)

items_summary <- dcpo_input_raw_pge1 %>%
  dplyr::select(country, year, item, survey) %>%
  separate_rows(survey, sep=",\\s+") %>% 
  distinct() %>%
  group_by(item) %>% 
  mutate(survey = str_extract(survey, "^[a-z]*"),
         all_surveys = paste0(unique(survey), collapse = ", ")) %>% 
  ungroup() %>% 
  distinct(country, year, item, .keep_all = TRUE) %>% 
  group_by(item) %>% 
  mutate(n_cy = n()) %>% 
  ungroup() %>%
  distinct(item, n_cy, all_surveys) %>% 
  left_join(surveys_pge %>%
              select(item, question_text) %>%
              distinct(item, .keep_all = TRUE),
            by = "item") %>% 
  left_join(alpha_results, by = "item") %>% 
  left_join(beta_results, by = "item") %>% 
  arrange(-n_cy)

```

```{r}
#| label: tbl-items

items_summary %>% 
  transmute(`Survey\nItem\nCode` = item,
            `Country-Years` = as.character(n_cy),
            `Question Text` = str_replace(question_text, "([^(]*)\\(.*", "\\1"),
            # `Response Categories` = response_categories,
            `Dispersion` = as.character(sprintf("%.2f", dispersion)),
            `Difficulties` = difficulties,
            `Survey Dataset Codes*` = all_surveys) %>% 
  modelsummary::datasummary_df(output = "kableExtra",
                               longtable = TRUE,
                               title = "Survey Items Used to Estimate Public Gender Egalitarianism Scores",
                               escape = FALSE) %>% 
  kableExtra::kable_styling(latex_options = c("repeat_header"),
                            font_size = 7) %>%
  kableExtra::column_spec(1, width = "7em") %>%
  kableExtra::column_spec(2, width = "4em") %>%
  kableExtra::column_spec(3, width = "16em") %>%
  # kableExtra::column_spec(3, width = "13em") %>%
  kableExtra::column_spec(4, width = "4em") %>%
  kableExtra::column_spec(c(5, 6), width = "8em") %>%
  kableExtra::footnote(symbol = "Survey dataset codes correspond to those used in the DCPOtools R package (Solt, Hu, and Tai 2019).")
```

\pagebreak
## Appendix C: Source Data Observations by Country and Year

\vspace{1cm}
```{r, fig.cap = "Source Data Observations by Country and Year", fig.height = 7}
#| label: fig-obs1

dcpo_input_plot <- dcpo_input_raw_pge1 %>% 
  filter(country %in% oecd_countries) %>% 
  distinct(country, year, item, cc_rank) %>% 
  group_by(country, year) %>% 
  summarize(n = n(),
            cc_rank = mean(cc_rank)) %>% 
  ungroup() 

dcpo_input_plot %>%
  ggplot(aes(x = year, 
             y = forcats::fct_reorder(country, cc_rank),
             fill = n)) + 
  geom_tile() +
  scale_fill_steps(low = rev(hcl.colors(8, "inferno"))[1],
                   high = rev(hcl.colors(8, "inferno"))[8],
                   breaks =  seq(2, 16, 2),
                   show.limits = TRUE,
                   right = FALSE,
                   name = "Observations") +
  labs(x = NULL, y = NULL) +
  scale_x_continuous(breaks=seq(1968, 2024, 4),
                     sec.axis = dup_axis()) +
  scale_y_discrete(position = "right") +
  theme(axis.text.x  = element_text(size = 6),
        axis.text.y  = element_text(size = 7),
        strip.background = element_rect(fill = "white", colour = "white"),
        strip.placement = "outside",
        legend.position = "bottom",
        # legend.position = c(0.13, 0.12),
        legend.background = element_rect(fill = "white", colour = NA))
```

\pagebreak
## Appendix D: Polarization in Korean Public Opinion by Demographic Group

One point often raised by observers of Korean politics with regard to the presidency of Park Geun-hye is that it ushered in a period of intense political polarization, a time in which the views of men and women, young and old, and those with more and less education moved in opposite directions.
If this is true, the average responses we examine in Chapter 6 may overlook additional signs of backlash against gender equality that are limited to particular Korean demographic groups and, within the entire public's opinion, counterbalanced by the views of other groups.

```{r, fig.cap="Trends in Mean Responses to Survey Items on Gender Equality in Politics by Demographic Groups in Korea", fig.height = 9}
#| label: fig-kd1mplot1

kd1_means <- rio::import(here::here("paper",
                                    "korea",
                                    "data-raw",
                                    "kd1_means.rda"),
                         trust = TRUE)

kd1_poli_summary <- kd1_means %>% 
              filter(item_type == "Politics") %>% 
              mutate(q = fct_reorder(question, n, .desc = TRUE)) %>% 
  group_by(q) %>% 
  summarize(year_min = 2013,
            year_max = 2016,
            mean = mean(mean))

caption <- "All survey items are coded so that more egalitarian responses have higher values. The shaded region indicates the years of Korea's first woman president, Park Geun-hye, from her election in 2013 to her impeachment and removal for corruption in 2016."

annote_text <- tibble(
  q = factor(levels(kd1_means %>% 
                      filter(item_type == "Politics") %>% 
                      pull(q) %>% 
                      fct_drop())[4], 
  levels = levels(kd1_means %>% 
                    filter(item_type == "Politics") %>% 
                    pull(q) %>%
                    fct_drop())),
  variable = factor(c("Gender", "Gender",
                      "Generation", "Generation", "Generation",
                      "Education", "Education"),
                    levels = c("Gender", "Generation", "Education"),
                    labels = c("Gender", "Generation", "Education")),
  value = factor(levels(kd1_means$value),
                 levels = levels(kd1_means$value)),
                 label = levels(kd1_means$value),
  year = c(2003.25, 2001.5, # politics plot
           2001.75, 2002.25, 2001.75,
           2002, 2003),
  mean = c(1.71, 1.87,
           1.71, 1.84, 1.92,
           1.77, 1.82))

kd1_means %>%
  filter(item_type == "Politics") %>% 
  ggplot() +
  geom_rect(data = kd1_poli_summary,
            aes(xmin = year_min, xmax = year_max, ymin = -Inf, ymax = Inf),
            fill = "gray95",
            color = "gray95",
            alpha = .6) +
  geom_text(data = annote_text,
            aes(x = year, y = mean, label = label, color = value),
            size = 3,
            alpha = .9) +
  geom_pointrange(aes(x = year, y = mean, ymin = low, ymax = hi, color = value),
                  fatten = 1, 
                  alpha = .5) +
  geom_line(aes(x = year, y = mean, color = value),
            linetype = "dotted") +
  facet_grid(q ~ variable,
             scales = "free_y",
             switch = "y",
             labeller = label_wrap_gen(31)) +
  theme_bw() +
  theme(legend.position="none",
        strip.background = element_blank(),
        strip.text.y.left = element_text(angle = 0),
        axis.text.x = element_text(angle = 90)) +
  scale_x_continuous(limits = c(1995, 2026),
                     breaks = seq(1995, 2025, by = 5),
                     labels = seq(1995, 2025, by = 5)) +
  scale_y_continuous(position = "right") +
  labs(x = NULL, y = NULL) +
  scale_color_manual(values = c("Men" = "grey65",
                                "Women" = "grey30",
                                "Boomer" = "grey65",
                                "GenX" = "grey50",
                                "GenMZ" = "grey30",
                                "No Uni" = "grey65",
                                "Uni" = "grey30"),
                     aesthetics = c("colour", "fill"))  +
  plot_annotation(caption = str_wrap(caption, 120))

```

```{r, fig.cap="Trends in Mean Responses to Survey Items on Gender Equality in the Workplace by Demographic Groups in Korea", fig.height = 9}
#| label: fig-kd1mplot2

kd1_work_summary <- kd1_means %>% 
              filter(item_type == "Workplace") %>% 
              mutate(q = fct_reorder(question, n, .desc = TRUE)) %>% 
  group_by(q) %>% 
  summarize(year_min = 2013,
            year_max = 2016,
            mean = mean(mean))

annote_text <- tibble(
  q = factor(levels(kd1_means %>% 
                      filter(!item_type == "Politics") %>% 
                      pull(q) %>% 
                      fct_drop())[6], 
  levels = levels(kd1_means %>% 
                    filter(!item_type == "Politics") %>% 
                    pull(q) %>%
                    fct_drop())),
  variable = factor(c("Gender", "Gender",
                      "Generation", "Generation", "Generation",
                      "Education", "Education"),
                    levels = c("Gender", "Generation", "Education"),
                    labels = c("Gender", "Generation", "Education")),
  value = factor(levels(kd1_means$value),
                 levels = levels(kd1_means$value)),
  label = levels(kd1_means$value),
  year = c(2006, 2004.5,  # workplace plot
           2005, 2005.5, 2005,
           2005, 2007),
  mean = c(2.15, 2.4,
           2.15, 2.33, 2.5,
           2.2, 2.33))

kd1_means %>%
  filter(!item_type == "Politics") %>% 
  ggplot() +
  geom_rect(data = kd1_work_summary,
            aes(xmin = year_min, xmax = year_max, ymin = -Inf, ymax = Inf),
            fill = "gray95",
            color = "gray95",
            alpha = .6) +
  geom_text(data = annote_text,
            aes(x = year, y = mean, color = value, label = label),
            size = 3,
            alpha = .9) +
  geom_pointrange(aes(x = year, y = mean, 
                      ymin = low, ymax = hi,
                      color = value),
                  fatten = 1, 
                  alpha = .4) +
  geom_line(aes(x = year, y = mean, color = value),
            linetype = "dotted") +
  facet_grid(q ~ variable,
             scales = "free_y",
             switch = "y",
             labeller = label_wrap_gen(31)) +
  theme_bw() +
  theme(legend.position="none",
        strip.background = element_blank(),
        strip.text.y.left = element_text(angle = 0),
        axis.text.x = element_text(angle = 90)) +
  scale_x_continuous(limits = c(1995, 2026),
                     breaks = seq(1995, 2025, by = 5),
                     labels = seq(1995, 2025, by = 5)) +
  scale_y_continuous(position = "right") +
  labs(x = NULL, y = NULL) +
  scale_color_manual(values = c("Men" = "grey70",
                                "Women" = "grey30",
                                "Boomer" = "grey70",
                                "GenX" = "grey50",
                                "GenMZ" = "grey30",
                                "No Uni" = "grey70",
                                "Uni" = "grey30"),
                     aesthetics = c("colour", "fill"))  +
  plot_annotation(caption = str_wrap("Shaded region indicates the years of Korea's first woman president, Park Geun-hye, from her election in 2013 to her impeachment and removal for corruption in 2016", 120))

```

We investigate this possibility in @fig-kd1mplot1.
Its plots breaks down the responses to the four survey items on gender equality in politics by gender, generation, and education, with darker lines representing women, younger cohorts, and those with university educations, respectively.^[
Following popular and scholarly practice in Korea, younger adults---millenials and members of Generation Z---are combined here into "Generation MZ" [see, e.g., @Koo2024].]
There are few signs that polarization is working to obscure backlash within these groups.
Instead, responses to most items tend to move similarly across groups.  

```{r, diff_functions}

rssq <- function(x) {
  sqrt(x[1]^2+x[2]^2)
}

mean_text <- function(item1, value1, years) {
  kd1_means %>% 
    filter(item == item1 &
             value == value1 &
             year %in% years) %>% 
    pull(mean) %>% 
    diff() %>% 
    abs() %>% 
    sprintf("%.2f", .)
}

ci_text <- function(item1, value1, years) {
  point_estimate <- kd1_means %>% 
    filter(item == item1 &
             value == value1 &
             year %in% years) %>% 
    pull(mean) %>%
    diff() %>% 
    abs()
  
  whisker <- kd1_means %>% 
    filter(item == item1 &
             value == value1 &
             year %in% years) %>% 
    pull(se) %>% 
    rssq() %>% 
    `*`(qnorm(.9))
  
  paste("80% c.i.:",
        sprintf("%.2f", point_estimate - whisker),
        "to",
        sprintf("%.2f", point_estimate + whisker))
}

```

A possible partial exception to the lack of evidence of polarization is the item, "Women should not be involved in politics as much as men," and shown in the second row of the figure.
This item was asked in the third wave of the AsianBarometer, fielded in Korea in 2011, two years before Park's election; its fourth wave, fielded in 2015, two years into her term; and its fifth wave, fielded in 2019, two years after Korea's Constitutional Court confirmed her impeachment.
For that item, women's views did not decline much over this time (`r mean_text("politics4", "Women", c(2011, 2019))` points on the item's four-point scale; `r ci_text("politics4", "Women", c(2011, 2019))`).
Men, on the other hand, were sharply less likely to disagree with the statement in 2015 (by `r mean_text("politics4", "Men", c(2011, 2015))` points; `r ci_text("politics4", "Men", c(2011, 2015))`) and 2019 (by `r mean_text("politics4", "Men", c(2011, 2019))` points; 80% c.i.: `r ci_text("politics4", "Men", c(2011, 2019))`) than in 2011.
But even this item showed more convergence than divergence across generations (in the center column) and levels of education (on the right-hand side).
And, in any event, it was not necessary to look separately at men's and women's responses to see a decline in the public's gender egalitarianism on this item; this decline is already visible in @fig-kd1allplot1.

@fig-kd1mplot2 provides hints of backlash that were not previously visible by expanding this analysis to groups' responses to survey questions on gender equality in the workplace.
Here there are a few signs that polarization concealed backlash in some subsets of the entire public.
First, the hint of a decline in egalitarian responses from 2016 to 2018 to the statement "it is more important for a wife to help her husband's career to have her own," when all respondents are considered in @fig-kd1allplot1 is revealed in the third row of this plot to have been the combination of steeper falls among baby boomers and those without university education and modest rises within people in other demographic groups. 
And second, baby boomers were less likely to disagree that "when jobs are scarce, men should have more right to a job than women" (in the bottom-most row) by `r mean_text("job4", "Boomer", c(2010, 2019))` points on that question's four point scale (`r ci_text("job4", "Boomer", c(2010, 2019))`) in 2019 than in 2010, a decline in egalitarianism that is outweighed by the increases among younger cohorts.
Some negative reactions to Park's presidency are evident, then, particularly among groups that disproportionately supported Park's election.
But it does not appear that there was a widespread backlash to gender equality triggered by Park's presidency that was hidden by polarization in the public's views.
