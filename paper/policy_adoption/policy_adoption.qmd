# From Public Egalitarianism to Equality: Understanding Policy Adoption

Gender quotas
Family leave
Anti-violence against women
Gender equality of opportunity: see Kim2022 and https://wbl.worldbank.org/en/wbl 

```{r quotas}
m0_party_quota <- party_pge %>%
  map(~ lmer(party_quota ~ pge_lag_by2sd +
               (1 | party) + (1 | cyear) + (1 | country), REML=FALSE,
             data = .x)) %>% 
  sim_and_tidy()

m1_party_quota <- party_pge %>%
  map(~ lmer(party_quota ~ pge_lag_by2sd +
               list +
               (1 | party) + (1 | cyear) + (1 | country), REML=FALSE,
             data = .x)) %>% 
  sim_and_tidy()

m2_party_quota <- party_pge %>%
  map(~ lmer(party_quota ~ pge_lag_by2sd +
               list +
               leftwing +
               pge_lag_by2sd:leftwing +
               (1 | party) + (1 | cyear) + (1 | country), REML=FALSE,
             data = .x)) %>% 
  sim_and_tidy()

m2_party_quota_a <- party_pge %>%
  map(~ lmer(party_quota ~ pge_lag +
               list +
               leftwing +
               pge_lag:leftwing +
               (1 | party) + (1 | cyear) + (1 | country), REML=FALSE,
             data = .x))

m3_party_quota <- party_pge %>%
  map(~ lmer(party_quota ~ pge_lag_by2sd +
               list +
               green +
               left +
               extreme_right +
               pge_lag_by2sd:green +
               pge_lag_by2sd:left +
               pge_lag_by2sd:extreme_right +
               (1 | party) + (1 | cyear) + (1 | country), REML=FALSE,
             data = .x)) %>% 
  sim_and_tidy()

m3_party_quota_a <- party_pge %>%
  map(~ lmer(party_quota ~ pge_lag +
               list +
               green +
               left +
               extreme_right +
               pge_lag:green +
               pge_lag:left +
               pge_lag:extreme_right +
               (1 | party) + (1 | cyear) + (1 | country), REML=FALSE,
             data = .x))

m02_party_quota <- bind_rows(m0_party_quota %>% 
                      mutate(model = "Model 0"),
                    m1_party_quota %>% 
                      mutate(model = "Model 1"),
                    m2_party_quota %>% 
                      mutate(model = "Model 2")) %>% 
  filter(!term=="(Intercept)")

quota_vars_proper <- c(bquote(PGE[t-1]),
                 "Party List",
                 "Leftwing Party",
                 bquote(PGE[t-1] %*% Leftwing~Party))

walk(1:3, function(mod) {
  m02_party_quota %>% 
    mutate(estimate = if_else(as.numeric(as_factor(model)) > mod,
                              NA_real_,
                              estimate),
           std.error = if_else(as.numeric(as_factor(model)) > mod,
                               NA_real_,
                               std.error)) %>% 
    dwplot() +
    scale_y_discrete(labels=do.call(expression, 
                                    rev(quota_vars_proper))) +
    theme_bw() +
    theme(legend.position="none",
          plot.title.position = "plot",
          axis.text  = element_text(size=12)) +
    geom_vline(xintercept = 0, colour = "grey60", linetype = 2) +
    coord_cartesian(xlim = c(min(m02_party_quota$estimate -
                                   1.96*m02_party_quota$std.error), 
                             max(m02_party_quota$estimate +
                                   1.96*m02_party_quota$std.error))) +
    scale_color_viridis_d(direction = -1,
                          end = .8) +
    xlab("Standardized Coefficients") +
    ggtitle("Multilevel Models of Gender Quotas")
  ggsave(here::here("paper",
                    "descriptive_representation",
                    paste0("m02_party_quota_", mod, ".jpg")))
})

interplot2(m2_party_quota_a, "leftwing", "pge_lag", hist = TRUE) +
  theme_bw() +
  theme(legend.position="none",
        axis.text  = element_text(size=10),
        axis.title = element_text(size=12)) +
  ylab("Coefficient for Leftwing Parties") +
  xlab(TeX("Public Gender Egalitarianism$_{t-1}$")) +
  geom_hline(yintercept = 0, colour = "grey60", linetype = 2) +
  ggtitle("Coefficients for Leftwing Parties\nby Public Gender Egalitarianism")
ggsave(file.path(descrep_path,
                  "quota_leftwing_by_pge.jpg"))

```
